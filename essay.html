<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Minimal Typing Trainer</title>
  <style>
    :root {
      --bg: #0f0f10;
      --fg: #e8e8ea;
      --muted: #9a9aa0;
      --good: #6ee7b7;
      --bad: #fb7185;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg);
      color: var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    .app { width: min(900px, 92vw); padding: 24px; }
    header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
    .controls { display:flex; gap:8px; flex-wrap:wrap; }
    button, select {
      background:#17171a; color:var(--fg); border:1px solid #24242a; border-radius:10px; padding:8px 12px; cursor:pointer;
    }
    .card { background:#121215; border:1px solid #24242a; border-radius:16px; padding:18px; }
    .text { font-size:20px; line-height:1.6; user-select:none; margin-bottom:12px; }
    .char { opacity:.4; }
    .char.correct { color:var(--good); opacity:1; }
    .char.wrong { color:var(--bad); opacity:1; text-decoration:underline; }
    .char.current { outline:1px solid #333; border-radius:4px; }
    textarea { width:100%; min-height:90px; background:#0f0f12; color:var(--fg); border:1px solid #24242a; border-radius:12px; padding:12px; font-size:16px; }
    .stats { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-top:12px; }
    .stat { background:#0f0f12; border:1px solid #24242a; border-radius:12px; padding:10px; text-align:center; }
    .label { color:var(--muted); font-size:12px; }
    .value { font-size:20px; }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div>Minimal Typing Trainer</div>
      <div class="controls">
        <select id="mode">
          <option value="essay">Essay</option>
          <option value="quotes">Quotes</option>
          <option value="custom">Your Text</option>
        </select>
        <button id="new">New</button>
        <button id="reset">Reset</button>
        <button id="stop">Stop</button>
      </div>
    </header>

    <div class="card">
      <div id="customBox" style="display:none; margin-bottom:12px;">
        <textarea id="customText" placeholder="Paste your own text here..."></textarea>
        <button id="useCustom" style="margin-top:8px;">Use My Text</button>
      </div>

      <div id="text" class="text"></div>
      <textarea id="input" placeholder="Start typing here..." spellcheck="false"></textarea>

      <div class="stats">
        <div class="stat"><div class="label">WPM</div><div id="wpm" class="value">0</div></div>
        <div class="stat"><div class="label">Accuracy</div><div id="acc" class="value">100%</div></div>
        <div class="stat"><div class="label">Time</div><div id="time" class="value">0s</div></div>
        <div class="stat"><div class="label">Errors</div><div id="errors" class="value">0</div></div>
      </div>
    </div>
  </div>

<script>
const essayTexts = [
  "Consistency beats intensity. Ten minutes every day will do more than one long session a week.",
  "Typing is a skill. Accuracy first, speed will follow with time and practice."
];

const quotes = [
  "Simplicity is the ultimate sophistication.",
  "What we think, we become.",
  "Stay hungry, stay foolish.",
  "Well begun is half done."
];

const textEl = document.getElementById('text');
const inputEl = document.getElementById('input');
const wpmEl = document.getElementById('wpm');
const accEl = document.getElementById('acc');
const timeEl = document.getElementById('time');
const errorsEl = document.getElementById('errors');
const newBtn = document.getElementById('new');
const resetBtn = document.getElementById('reset');
const stopBtn = document.getElementById('stop');
const modeSel = document.getElementById('mode');
const customBox = document.getElementById('customBox');
const customTextEl = document.getElementById('customText');
const useCustomBtn = document.getElementById('useCustom');

let target = "";
let startTime = null;
let timer = null;
let errors = 0;
let stopped = false;

function pickText() {
  if (modeSel.value === 'essay') {
    return essayTexts[Math.floor(Math.random() * essayTexts.length)];
  } else if (modeSel.value === 'quotes') {
    let t = [];
    for (let i = 0; i < 5; i++) t.push(quotes[Math.floor(Math.random() * quotes.length)]);
    return t.join(' ');
  } else {
    return customTextEl.value.trim() || "Paste your own text above and click 'Use My Text'.";
  }
}

function renderTarget() {
  textEl.innerHTML = '';
  for (let i = 0; i < target.length; i++) {
    const span = document.createElement('span');
    span.textContent = target[i];
    span.className = 'char' + (i === 0 ? ' current' : '');
    textEl.appendChild(span);
  }
}

function resetAll(newText) {
  if (newText) target = pickText();
  renderTarget();
  inputEl.value = '';
  startTime = null;
  if (timer) clearInterval(timer);
  timer = null;
  errors = 0;
  stopped = false;
  wpmEl.textContent = '0';
  accEl.textContent = '100%';
  timeEl.textContent = '0s';
  errorsEl.textContent = '0';
}

function startTimer() {
  startTime = Date.now();
  timer = setInterval(updateStats, 500);
}

function stopTimer() {
  if (timer) {
    clearInterval(timer);
    timer = null;
  }
  stopped = true;
}

function updateStats() {
  if (!startTime) return;
  const elapsed = (Date.now() - startTime) / 1000;
  timeEl.textContent = Math.floor(elapsed) + 's';
  const typed = inputEl.value.length;
  const wpm = elapsed > 0 ? Math.round((typed / 5) / (elapsed / 60)) : 0;
  wpmEl.textContent = wpm;
  const correct = countCorrect();
  const acc = typed > 0 ? Math.round((correct / typed) * 100) : 100;
  accEl.textContent = acc + '%';
  errorsEl.textContent = errors;
}

function countCorrect() {
  const val = inputEl.value;
  let c = 0;
  for (let i = 0; i < val.length && i < target.length; i++) {
    if (val[i] === target[i]) c++;
  }
  return c;
}

inputEl.addEventListener('input', () => {
  if (stopped) return;
  if (!startTime && inputEl.value.length > 0) startTimer();
  const val = inputEl.value;
  const spans = textEl.querySelectorAll('.char');
  errors = 0;
  for (let i = 0; i < spans.length; i++) {
    const ch = spans[i];
    ch.classList.remove('correct','wrong','current');
    if (i < val.length) {
      if (val[i] === target[i]) ch.classList.add('correct');
      else { ch.classList.add('wrong'); errors++; }
    } else if (i === val.length) {
      ch.classList.add('current');
    }
  }
  updateStats();
});

newBtn.onclick = () => resetAll(true);
resetBtn.onclick = () => resetAll(false);
stopBtn.onclick = () => stopTimer();

modeSel.onchange = () => {
  customBox.style.display = modeSel.value === 'custom' ? 'block' : 'none';
  resetAll(true);
};

useCustomBtn.onclick = () => {
  modeSel.value = 'custom';
  customBox.style.display = 'block';
  resetAll(true);
};

// init
target = pickText();
resetAll(false);
</script>
</body>
</html>